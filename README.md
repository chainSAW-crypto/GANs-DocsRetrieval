# IRGAN - Information Retrieval Generative Adversarial Network

This project implements an Information Retrieval system using Generative Adversarial Networks (GANs) for document ranking and retrieval. Designed with a custom adversarial framework and discriminator for document retrieval, this system eliminates the need for embedding conversion of input text while improving query speed and reducing memory usage over traditional models. The system uses adversarial training between a generator and discriminator to improve document ranking performance.

## Project Structure

```
├── IRGAN-Training.ipynb        # Main training notebook
├── IRGAN_Dataset_creation.ipynb # Dataset preparation notebook
├── data/                       # Data directory
│   ├── documents.json          # Document collection
│   ├── labeled_data.json       # Training data
│   └── query_doc_pairs.json    # Query-document pairs
├── document_base-cows/         # Source documents for cattle health
├── discriminator_model.pth     # Saved model weights
└── training_history.json       # Training metrics and history
```

## Features

- Adversarial training for document ranking
- Early stopping with patience for optimal model selection
- Comprehensive evaluation metrics including:
  - Accuracy
  - Precision
  - Recall
  - F1 Score
  - ROC AUC
- Training visualization with loss curves and metrics
- Model checkpointing for best performance

## Requirements

- Python 3.x
- PyTorch
- NumPy
- scikit-learn
- matplotlib
- tqdm

## Model Architecture

The system consists of two main components that work together in an adversarial framework:

1. **Generator (G)**: Acts as a smart document sampler that learns to pick documents that look relevant to a query (e.g., "limping cow symptoms"). It ranks documents by relevance probability using its learned distribution pθ(d|q).

2. **Discriminator (D)**: Acts as a relevance checker that tries to distinguish if a document is truly relevant or just generated by G. It provides feedback to improve the generator's selections.

### How Document Ranking Works

1. **For a New Query** (e.g., "cow limping treatment"):
   - G ranks all documents by relevance probability
   - Top-ranked docs are those G thinks will fool D the most—meaning they're likely truly relevant

### Advantages Over Traditional Methods

1. **Traditional BM25**:
   - Only matches keywords (e.g., "limping" ≈ "lameness")
   - Limited semantic understanding

2. **Fine-tuned Embeddings**:
   - Static similarity (e.g., SBERT maps "limping" to vector close to "leg pain")
   - Cannot adapt to context changes

3. **IRGAN Advantages**:
   - Dynamically adapts to D's feedback
   - Learns subtle contextual cues (e.g., in veterinary context, "limping + reduced eating" ≈ "acidosis risk")
   - Improves query speed through direct document ranking
   - Reduces memory usage by eliminating embedding conversion

### Training Process

- Batch size: 64
- Learning rate: 0.001
- Optimizer: Adam
- Loss function: Binary Cross Entropy
- Early stopping patience: 5 epochs

## Usage

1. **Data Preparation**:
   - Use `IRGAN_Dataset_creation.ipynb` to prepare your dataset
   - Ensure data is in the correct format (query-document pairs)

2. **Training**:
   - Run `IRGAN-Training.ipynb` to train the model
   - Monitor training progress through metrics and visualizations
   - Model checkpoints are saved automatically

3. **Evaluation**:
   - The system provides comprehensive evaluation metrics
   - Visualizations are saved as PNG files:
     - training_history.png
     - confusion_matrix.png
     - roc_curve.png

## Model Output

The training process saves:
- Best model weights (`discriminator_model.pth`)
- Training history (`training_history.json`)
- Performance visualizations

## Performance Monitoring

The training process includes:
- Real-time loss tracking for both generator and discriminator
- Validation metrics after each epoch
- Early stopping to prevent overfitting
- Comprehensive evaluation on test set

## License

This project is open-source and available under the MIT License.

## Acknowledgments

This implementation is based on the IRGAN paper and adapted for document ranking in the context of cattle health information retrieval.
